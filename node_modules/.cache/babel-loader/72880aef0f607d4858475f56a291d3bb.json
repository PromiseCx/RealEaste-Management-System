{"remainingRequest":"D:\\webproject\\node_modules\\babel-loader\\lib\\index.js!D:\\webproject\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\webproject\\src\\store\\modules\\user.js","dependencies":[{"path":"D:\\webproject\\src\\store\\modules\\user.js","mtime":1587215010029},{"path":"D:\\webproject\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\webproject\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\webproject\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmciOwppbXBvcnQgVnVlIGZyb20gJ3Z1ZSc7CmltcG9ydCB7IGxvZ2luLCBnZXRJbmZvLCBsb2dvdXQgfSBmcm9tICdAL2FwaS9sb2dpbic7CmltcG9ydCB7IEFDQ0VTU19UT0tFTiB9IGZyb20gJ0Avc3RvcmUvbXV0YXRpb24tdHlwZXMnOwppbXBvcnQgeyB3ZWxjb21lIH0gZnJvbSAnQC91dGlscy91dGlsJzsKdmFyIHVzZXIgPSB7CiAgc3RhdGU6IHsKICAgIHRva2VuOiAnJywKICAgIG5hbWU6ICcnLAogICAgd2VsY29tZTogJycsCiAgICBhdmF0YXI6ICcnLAogICAgcm9sZXM6IFtdLAogICAgaW5mbzoge30KICB9LAogIG11dGF0aW9uczogewogICAgU0VUX1RPS0VOOiBmdW5jdGlvbiBTRVRfVE9LRU4oc3RhdGUsIHRva2VuKSB7CiAgICAgIHN0YXRlLnRva2VuID0gdG9rZW47CiAgICB9LAogICAgU0VUX05BTUU6IGZ1bmN0aW9uIFNFVF9OQU1FKHN0YXRlLCBfcmVmKSB7CiAgICAgIHZhciBuYW1lID0gX3JlZi5uYW1lLAogICAgICAgICAgd2VsY29tZSA9IF9yZWYud2VsY29tZTsKICAgICAgc3RhdGUubmFtZSA9IG5hbWU7CiAgICAgIHN0YXRlLndlbGNvbWUgPSB3ZWxjb21lOwogICAgfSwKICAgIFNFVF9BVkFUQVI6IGZ1bmN0aW9uIFNFVF9BVkFUQVIoc3RhdGUsIGF2YXRhcikgewogICAgICBzdGF0ZS5hdmF0YXIgPSBhdmF0YXI7CiAgICB9LAogICAgU0VUX1JPTEVTOiBmdW5jdGlvbiBTRVRfUk9MRVMoc3RhdGUsIHJvbGVzKSB7CiAgICAgIHN0YXRlLnJvbGVzID0gcm9sZXM7CiAgICB9LAogICAgU0VUX0lORk86IGZ1bmN0aW9uIFNFVF9JTkZPKHN0YXRlLCBpbmZvKSB7CiAgICAgIHN0YXRlLmluZm8gPSBpbmZvOwogICAgfQogIH0sCiAgYWN0aW9uczogewogICAgLy8g55m75b2VCiAgICBMb2dpbjogZnVuY3Rpb24gTG9naW4oX3JlZjIsIHVzZXJJbmZvKSB7CiAgICAgIHZhciBjb21taXQgPSBfcmVmMi5jb21taXQ7CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgbG9naW4odXNlckluZm8pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICB2YXIgcmVzdWx0ID0gcmVzcG9uc2UucmVzdWx0OwogICAgICAgICAgY29uc29sZS5sb2coJy0tLS0tJyArIHJlc3VsdCk7CiAgICAgICAgICBWdWUubHMuc2V0KEFDQ0VTU19UT0tFTiwgcmVzdWx0LnRva2VuLCA3ICogMjQgKiA2MCAqIDYwICogMTAwMCk7CiAgICAgICAgICBjb21taXQoJ1NFVF9UT0tFTicsIHJlc3VsdC50b2tlbik7CiAgICAgICAgICByZXNvbHZlKCk7CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICByZWplY3QoZXJyb3IpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICAvLyDojrflj5bnlKjmiLfkv6Hmga8KICAgIEdldEluZm86IGZ1bmN0aW9uIEdldEluZm8oX3JlZjMpIHsKICAgICAgdmFyIGNvbW1pdCA9IF9yZWYzLmNvbW1pdDsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICBnZXRJbmZvKCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIHZhciByZXN1bHQgPSByZXNwb25zZS5yZXN1bHQ7CiAgICAgICAgICBjb25zb2xlLmxvZygnLS0tJyArIHJlc3VsdCk7CgogICAgICAgICAgaWYgKHJlc3VsdC5yb2xlICYmIHJlc3VsdC5yb2xlLnBlcm1pc3Npb25zLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgdmFyIHJvbGUgPSByZXN1bHQucm9sZTsKICAgICAgICAgICAgcm9sZS5wZXJtaXNzaW9ucyA9IHJlc3VsdC5yb2xlLnBlcm1pc3Npb25zOwogICAgICAgICAgICByb2xlLnBlcm1pc3Npb25zLm1hcChmdW5jdGlvbiAocGVyKSB7CiAgICAgICAgICAgICAgaWYgKHBlci5hY3Rpb25FbnRpdHlTZXQgIT0gbnVsbCAmJiBwZXIuYWN0aW9uRW50aXR5U2V0Lmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSBwZXIuYWN0aW9uRW50aXR5U2V0Lm1hcChmdW5jdGlvbiAoYWN0aW9uKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb24uYWN0aW9uOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBwZXIuYWN0aW9uTGlzdCA9IGFjdGlvbjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByb2xlLnBlcm1pc3Npb25MaXN0ID0gcm9sZS5wZXJtaXNzaW9ucy5tYXAoZnVuY3Rpb24gKHBlcm1pc3Npb24pIHsKICAgICAgICAgICAgICByZXR1cm4gcGVybWlzc2lvbi5wZXJtaXNzaW9uSWQ7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBjb21taXQoJ1NFVF9ST0xFUycsIHJlc3VsdC5yb2xlKTsKICAgICAgICAgICAgY29tbWl0KCdTRVRfSU5GTycsIHJlc3VsdCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZWplY3QobmV3IEVycm9yKCdnZXRJbmZvOiByb2xlcyBtdXN0IGJlIGEgbm9uLW51bGwgYXJyYXkgIScpKTsKICAgICAgICAgIH0KCiAgICAgICAgICBjb21taXQoJ1NFVF9OQU1FJywgewogICAgICAgICAgICBuYW1lOiByZXN1bHQubmFtZSwKICAgICAgICAgICAgd2VsY29tZTogd2VsY29tZSgpCiAgICAgICAgICB9KTsKICAgICAgICAgIGNvbW1pdCgnU0VUX0FWQVRBUicsIHJlc3VsdC5hdmF0YXIpOwogICAgICAgICAgcmVzb2x2ZShyZXNwb25zZSk7CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICByZWplY3QoZXJyb3IpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICAvLyDnmbvlh7oKICAgIExvZ291dDogZnVuY3Rpb24gTG9nb3V0KF9yZWY0KSB7CiAgICAgIHZhciBjb21taXQgPSBfcmVmNC5jb21taXQsCiAgICAgICAgICBzdGF0ZSA9IF9yZWY0LnN0YXRlOwogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgICBsb2dvdXQoc3RhdGUudG9rZW4pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJlc29sdmUoKTsKICAgICAgICB9KS5maW5hbGx5KGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGNvbW1pdCgnU0VUX1RPS0VOJywgJycpOwogICAgICAgICAgY29tbWl0KCdTRVRfUk9MRVMnLCBbXSk7CiAgICAgICAgICBWdWUubHMucmVtb3ZlKEFDQ0VTU19UT0tFTik7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0KfTsKZXhwb3J0IGRlZmF1bHQgdXNlcjs="},{"version":3,"sources":["D:/webproject/src/store/modules/user.js"],"names":["Vue","login","getInfo","logout","ACCESS_TOKEN","welcome","user","state","token","name","avatar","roles","info","mutations","SET_TOKEN","SET_NAME","SET_AVATAR","SET_ROLES","SET_INFO","actions","Login","userInfo","commit","Promise","resolve","reject","then","response","result","console","log","ls","set","catch","error","GetInfo","role","permissions","length","map","per","actionEntitySet","action","actionList","permissionList","permission","permissionId","Error","Logout","finally","remove"],"mappings":"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","sourcesContent":["import Vue from 'vue'\nimport { login, getInfo, logout } from '@/api/login'\nimport { ACCESS_TOKEN } from '@/store/mutation-types'\nimport { welcome } from '@/utils/util'\n\nconst user = {\n    state: {\n        token: '',\n        name: '',\n        welcome: '',\n        avatar: '',\n        roles: [],\n        info: {}\n    },\n\n    mutations: {\n        SET_TOKEN: (state, token) => {\n            state.token = token\n        },\n        SET_NAME: (state, { name, welcome }) => {\n            state.name = name\n            state.welcome = welcome\n        },\n        SET_AVATAR: (state, avatar) => {\n            state.avatar = avatar\n        },\n        SET_ROLES: (state, roles) => {\n            state.roles = roles\n        },\n        SET_INFO: (state, info) => {\n            state.info = info\n        }\n    },\n\n    actions: {\n        // 登录\n        Login({ commit }, userInfo) {\n            return new Promise((resolve, reject) => {\n                login(userInfo)\n                    .then(response => {\n                        const result = response.result\n                        console.log('-----' + result)\n                        Vue.ls.set(ACCESS_TOKEN, result.token, 7 * 24 * 60 * 60 * 1000)\n                        commit('SET_TOKEN', result.token)\n                        resolve()\n                    })\n                    .catch(error => {\n                        reject(error)\n                    })\n            })\n        },\n\n        // 获取用户信息\n        GetInfo({ commit }) {\n            return new Promise((resolve, reject) => {\n                getInfo()\n                    .then(response => {\n                        const result = response.result\n                        console.log('---' + result)\n                        if (result.role && result.role.permissions.length > 0) {\n                            const role = result.role\n                            role.permissions = result.role.permissions\n                            role.permissions.map(per => {\n                                if (per.actionEntitySet != null && per.actionEntitySet.length > 0) {\n                                    const action = per.actionEntitySet.map(action => {\n                                        return action.action\n                                    })\n                                    per.actionList = action\n                                }\n                            })\n                            role.permissionList = role.permissions.map(permission => {\n                                return permission.permissionId\n                            })\n                            commit('SET_ROLES', result.role)\n                            commit('SET_INFO', result)\n                        } else {\n                            reject(new Error('getInfo: roles must be a non-null array !'))\n                        }\n\n                        commit('SET_NAME', { name: result.name, welcome: welcome() })\n                        commit('SET_AVATAR', result.avatar)\n\n                        resolve(response)\n                    })\n                    .catch(error => {\n                        reject(error)\n                    })\n            })\n        },\n\n        // 登出\n        Logout({ commit, state }) {\n            return new Promise(resolve => {\n                logout(state.token)\n                    .then(() => {\n                        resolve()\n                    })\n                    .catch(() => {\n                        resolve()\n                    })\n                    .finally(() => {\n                        commit('SET_TOKEN', '')\n                        commit('SET_ROLES', [])\n                        Vue.ls.remove(ACCESS_TOKEN)\n                    })\n            })\n        }\n    }\n}\n\nexport default user\n"]}]}